{"id":"bigquery","type":"class","name":"BigQuery","description":"<p>The object returned from <code>gcloud.bigquery</code> gives you complete access to and control of your BigQuery datasets. You can work with existing ones, by using the <code>dataset</code> method, or create new ones with <code>createDataset</code>.</p><p>To learn more about BigQuery, see <a href=\"https://cloud.google.com/bigquery/what-is-bigquery\">What is BigQuery?</a></p>","source":"lib/bigquery/index.js","parent":null,"children":["bigquery/dataset","bigquery/job","bigquery/table"],"methods":[{"id":"BigQuery","name":"BigQuery","type":"constructor","description":"<p>The examples below will demonstrate the different usage patterns your app may need to support to retrieve a BigQuery object.</p>","source":"lib/bigquery/index.js#L98","resources":[],"examples":[{"code":"var gcloud = require('gcloud')({\n  keyFilename: '/path/to/keyfile.json',\n  projectId: 'my-project'\n});\n\nvar bigquery = gcloud.bigquery();"},{"caption":"<p>In the following examples from this page and the other modules (Dataset, \nTable, etc.), we are going to be using a dataset from \n<a href=\"http://goo.gl/f2SXcb\">data.gov</a> of higher education \ninstitutions. \nWe will create a table with the correct schema, import the public CSV \nfile into that table, and query it for data.</p>"}],"params":[{"name":"options","description":"<ul> <li><a href=\"#/docs\">Configuration object</a>.</li> </ul> ","types":["object"],"optional":false,"nullable":false}],"exceptions":[],"returns":[]},{"id":"createDataset","name":"createDataset","type":"instance","description":"<p>Create a dataset.</p>","source":"lib/bigquery/index.js#L130","resources":[{"title":"Datasets: insert API Documentation","link":"https://cloud.google.com/bigquery/docs/reference/v2/datasets/insert"}],"examples":[{"code":"bigquery.createDataset('my-dataset', function(err, dataset, apiResponse) {});"}],"params":[{"name":"id","description":"<ul> <li>ID of the dataset to create.</li> </ul> ","types":["string"],"optional":false,"nullable":false},{"name":"options","description":"<ul> <li>See a <a href=\"https://cloud.google.com/bigquery/docs/reference/v2/datasets#resource\">Dataset resource</a>.</li> </ul> ","types":["object"],"optional":true,"nullable":false},{"name":"callback","description":"<ul> <li>The callback function.</li> </ul> ","types":["function"],"optional":false,"nullable":false},{"name":"callback.err","description":"<ul> <li>An error returned while making this request</li> </ul> ","types":["error"],"optional":false,"nullable":true},{"name":"callback.dataset","description":"<ul> <li>The newly created dataset</li> </ul> ","types":["<a data-custom-type=\"bigquery/dataset\" data-method=\"\">bigquery/dataset</a>"],"optional":false,"nullable":false},{"name":"callback.apiResponse","description":"<ul> <li>The full API response.</li> </ul> ","types":["object"],"optional":false,"nullable":false}],"exceptions":[],"returns":[]},{"id":"dataset","name":"dataset","type":"instance","description":"<p>Create a reference to a dataset.</p>","source":"lib/bigquery/index.js#L168","resources":[],"examples":[{"code":"var dataset = bigquery.dataset('higher_education');"}],"params":[{"name":"id","description":"<ul> <li>ID of the dataset.</li> </ul> ","types":["string"],"optional":false,"nullable":false}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"bigquery/dataset\" data-method=\"\">bigquery/dataset</a>"],"description":""}]},{"id":"getDatasets","name":"getDatasets","type":"instance","description":"<p>List all or some of the datasets in your project.</p>","source":"lib/bigquery/index.js#L236","resources":[{"title":"Datasets: list API Documentation","link":"https://cloud.google.com/bigquery/docs/reference/v2/datasets/list"}],"examples":[{"code":"bigquery.getDatasets(function(err, datasets) {\n  if (!err) {\n    // datasets is an array of Dataset objects.\n  }\n});"},{"caption":"<p>To control how many API requests are made and page through the results \nmanually, set <code>autoPaginate</code> to <code>false</code>.</p>","code":"var callback = function(err, datasets, nextQuery, apiResponse) {\n  if (nextQuery) {\n    // More results exist.\n    bigquery.getDatasets(nextQuery, callback);\n  }\n};\n\nbigquery.getDatasets({\n  autoPaginate: false\n}, callback);"},{"caption":"<p>Get the datasets from your project as a readable object stream.</p>","code":"bigquery.getDatasets()\n  .on('error', console.error)\n  .on('data', function(dataset) {\n    // dataset is a Dataset object.\n  })\n  .on('end', function() {\n    // All datasets retrieved.\n  });"},{"caption":"<p>If you anticipate many results, you can end a stream early to prevent \nunnecessary processing and API requests.</p>","code":"bigquery.getDatasets()\n  .on('data', function(dataset) {\n    this.end();\n  });"}],"params":[{"name":"query","description":"<ul> <li>Configuration object.</li> </ul> ","types":["object"],"optional":true,"nullable":false},{"name":"query.all","description":"<ul> <li>List all datasets, including hidden ones.</li> </ul> ","types":["boolean"],"optional":false,"nullable":false},{"name":"query.autoPaginate","description":"<ul> <li>Have pagination handled automatically. Default: true.</li> </ul> ","types":["boolean"],"optional":false,"nullable":false},{"name":"query.maxApiCalls","description":"<ul> <li>Maximum number of API calls to make.</li> </ul> ","types":["number"],"optional":false,"nullable":false},{"name":"query.maxResults","description":"<ul> <li>Maximum number of results to return.</li> </ul> ","types":["number"],"optional":false,"nullable":false},{"name":"query.pageToken","description":"<ul> <li>Token returned from a previous call, to request the next page of results.</li> </ul> ","types":["string"],"optional":false,"nullable":false},{"name":"callback","description":"<ul> <li>The callback function.</li> </ul> ","types":["function"],"optional":true,"nullable":false},{"name":"callback.err","description":"<ul> <li>An error returned while making this request</li> </ul> ","types":["error"],"optional":false,"nullable":true},{"name":"callback.datasets","description":"<ul> <li>The list of datasets in your project.</li> </ul> ","types":["<a data-custom-type=\"bigquery/dataset[]\" data-method=\"\">bigquery/dataset[]</a>"],"optional":false,"nullable":false},{"name":"callback.nextQuery","description":"<ul> <li>If present, query with this object to check for more results.</li> </ul> ","types":["object"],"optional":false,"nullable":true},{"name":"callback.apiResponse","description":"<ul> <li>The full API response.</li> </ul> ","types":["object"],"optional":false,"nullable":false}],"exceptions":[],"returns":[]},{"id":"getJobs","name":"getJobs","type":"instance","description":"<p>Get all of the jobs from your project.</p>","source":"lib/bigquery/index.js#L343","resources":[{"title":"Jobs: list API Documentation","link":"https://cloud.google.com/bigquery/docs/reference/v2/jobs/list"}],"examples":[{"code":"bigquery.getJobs(function(err, jobs) {\n  if (!err) {\n    // jobs is an array of Job objects.\n  }\n});"},{"caption":"<p>To control how many API requests are made and page through the results \nmanually, set <code>autoPaginate</code> to <code>false</code>.</p>","code":"var callback = function(err, jobs, nextQuery, apiRespose) {\n  if (nextQuery) {\n    // More results exist.\n    bigquery.getJobs(nextQuery, callback);\n  }\n};\n\nbigquery.getJobs({\n  autoPaginate: false\n}, callback);"},{"caption":"<p>Get the jobs from your project as a readable object stream.</p>","code":"bigquery.getJobs()\n  .on('error', console.error)\n  .on('data', function(job) {\n    // job is a Job object.\n  })\n  .on('end', function() {\n    // All jobs retrieved.\n  });"},{"caption":"<p>If you anticipate many results, you can end a stream early to prevent \nunnecessary processing and API requests.</p>","code":"bigquery.getJobs()\n  .on('data', function(job) {\n    this.end();\n  });"}],"params":[{"name":"options","description":"<ul> <li>Configuration object.</li> </ul> ","types":["object"],"optional":true,"nullable":false},{"name":"options.allUsers","description":"<ul> <li>Display jobs owned by all users in the project.</li> </ul> ","types":["boolean"],"optional":true,"nullable":false},{"name":"options.autoPaginate","description":"<ul> <li>Have pagination handled automatically. Default: true.</li> </ul> ","types":["boolean"],"optional":false,"nullable":false},{"name":"options.maxApiCalls","description":"<ul> <li>Maximum number of API calls to make.</li> </ul> ","types":["number"],"optional":false,"nullable":false},{"name":"options.maxResults","description":"<ul> <li>Maximum number of results to return.</li> </ul> ","types":["number"],"optional":true,"nullable":false},{"name":"options.pageToken","description":"<ul> <li>Token returned from a previous call, to request the next page of results.</li> </ul> ","types":["string"],"optional":true,"nullable":false},{"name":"options.projection","description":"<ul> <li>Restrict information returned to a set of selected fields. Acceptable values are &quot;full&quot;, for all job data, and  &quot;minimal&quot;, to not include the job configuration.</li> </ul> ","types":["string"],"optional":true,"nullable":false},{"name":"options.stateFilter","description":"<ul> <li>Filter for job state. Acceptable values are &quot;done&quot;, &quot;pending&quot;, and &quot;running&quot;.</li> </ul> ","types":["string"],"optional":true,"nullable":false},{"name":"callback","description":"<ul> <li>The callback function.</li> </ul> ","types":["function"],"optional":true,"nullable":false},{"name":"callback.err","description":"<ul> <li>An error returned while making this request</li> </ul> ","types":["error"],"optional":false,"nullable":true},{"name":"callback.jobs","description":"<ul> <li>The list of jobs in your project.</li> </ul> ","types":["<a data-custom-type=\"bigquery/job[]\" data-method=\"\">bigquery/job[]</a>"],"optional":false,"nullable":false},{"name":"callback.nextQuery","description":"<ul> <li>If present, query with this object to check for more results.</li> </ul> ","types":["object"],"optional":false,"nullable":true},{"name":"callback.apiResponse","description":"<ul> <li>The full API response.</li> </ul> ","types":["object"],"optional":false,"nullable":false}],"exceptions":[],"returns":[]},{"id":"job","name":"job","type":"instance","description":"<p>Create a reference to an existing job.</p>","source":"lib/bigquery/index.js#L389","resources":[],"examples":[{"code":"var myExistingJob = bigquery.job('job-id');"}],"params":[{"name":"id","description":"<ul> <li>ID of the job.</li> </ul> ","types":["string"],"optional":false,"nullable":false}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"bigquery/job\" data-method=\"\">bigquery/job</a>"],"description":""}]},{"id":"query","name":"query","type":"instance","description":"<p>Run a query scoped to your project.</p><p>If you provide a callback, this method returns the results from your query to it. When querying large sets of data, it is possible your results won&#39;t be returned all at once. In those cases, you will receive a third argument to your callback that can be passed back to this method to return more results.</p><p>See the examples below for such a workflow.</p><p>This method also runs as a readable stream if you do not provide a callback. In cases where more results exist, this will automatically run the subsequent queries for you, pushing each row to the stream.</p>","source":"lib/bigquery/index.js#L473","resources":[{"title":"Jobs: query API Documentation","link":"https://cloud.google.com/bigquery/docs/reference/v2/jobs/query"}],"examples":[{"code":"var query = 'SELECT url FROM [publicdata:samples.github_nested] LIMIT 100';\n\nbigquery.query(query, function(err, rows) {\n  if (!err) {\n    // Handle results here.\n  }\n});"},{"caption":"<p>To control how many API requests are made and page through the results \nmanually, set <code>autoPaginate</code> to <code>false</code>.</p>","code":"var callback = function(err, rows, nextQuery, apiResponse) {\n  if (nextQuery) {\n    bigquery.query(nextQuery, callback);\n  }\n};\n\nbigquery.query({\n  query: query,\n  autoPaginate: false\n}, callback);"},{"caption":"<p>You can also use the <code>query</code> method as a readable object stream by \nomitting the callback.</p>","code":"bigquery.query(query)\n  .on('error', console.error)\n  .on('data', function(row) {\n    // row is a result from your query.\n  })\n  .on('end', function() {\n    // All rows retrieved.\n  });"},{"caption":"<p>If you anticipate many results, you can end a stream early to prevent \nunnecessary processing and API requests.</p>","code":"bigquery.query(query)\n  .on('data', function(row) {\n    this.end();\n  });"}],"params":[{"name":"options","description":"<ul> <li>A string SQL query or configuration object.</li> </ul> ","types":["string","object"],"optional":false,"nullable":false},{"name":"options.autoPaginate","description":"<ul> <li>Have pagination handled automatically. Default: true.</li> </ul> ","types":["boolean"],"optional":false,"nullable":false},{"name":"options.maxApiCalls","description":"<ul> <li>Maximum number of API calls to make.</li> </ul> ","types":["number"],"optional":false,"nullable":false},{"name":"options.maxResults","description":"<ul> <li>Maximum number of results to read.</li> </ul> ","types":["number"],"optional":false,"nullable":false},{"name":"options.query","description":"<ul> <li>A query string, following the BigQuery query syntax, of the query to execute.</li> </ul> ","types":["string"],"optional":false,"nullable":false},{"name":"options.timeoutMs","description":"<ul> <li>How long to wait for the query to complete, in milliseconds, before returning. Default is to return  immediately. If the timeout passes before the job completes, the request  will fail with a <code>TIMEOUT</code> error.</li> </ul> ","types":["number"],"optional":false,"nullable":false},{"name":"callback","description":"<ul> <li>The callback function.</li> </ul> ","types":["function"],"optional":true,"nullable":false},{"name":"callback.err","description":"<ul> <li>An error returned while making this request</li> </ul> ","types":["error"],"optional":false,"nullable":true},{"name":"callback.rows","description":"<ul> <li>The list of results from your query.</li> </ul> ","types":["array"],"optional":false,"nullable":false},{"name":"callback.nextQuery","description":"<ul> <li>If present, query with this object to check for more results.</li> </ul> ","types":["object"],"optional":false,"nullable":true},{"name":"callback.apiResponse","description":"<ul> <li>The full API response.</li> </ul> ","types":["object"],"optional":false,"nullable":false}],"exceptions":[],"returns":[]},{"id":"startQuery","name":"startQuery","type":"instance","description":"<p>Run a query as a job. No results are immediately returned. Instead, your callback will be executed with a <a data-custom-type=\"bigquery/job\" data-method=\"\">bigquery/job</a> object that you must ping for the results. See the Job documentation for explanations of how to check on the status of the job.</p>","source":"lib/bigquery/index.js#L588","resources":[{"title":"Jobs: insert API Documentation","link":"https://cloud.google.com/bigquery/docs/reference/v2/jobs/insert"}],"examples":[{"code":"var query = 'SELECT url FROM [publicdata:samples.github_nested] LIMIT 100';"},{"caption":"<p>You may pass only a query string, having a new table created to store the \nresults of the query.</p>","code":"bigquery.startQuery(query, function(err, job) {});"},{"caption":"<p>You can also control the destination table by providing a \n<a data-custom-type=\"bigquery/table\" data-method=\"\">bigquery/table</a> object.</p>","code":"bigquery.startQuery({\n  destination: bigquery.dataset('higher_education').table('institutions'),\n  query: query\n}, function(err, job) {});"},{"caption":"<p>After you have run <code>startQuery</code>, your query will execute in a job. Your \ncallback is executed with a <a data-custom-type=\"bigquery/job\" data-method=\"\">bigquery/job</a> object so that you may \ncheck for the results.</p>","code":"bigquery.startQuery(query, function(err, job) {\n  if (!err) {\n    job.getQueryResults(function(err, rows, apiResponse) {});\n  }\n});"}],"params":[{"name":"options","description":"<ul> <li>The configuration object. This must be in the format of the <a href=\"http://goo.gl/wRpHvR\"><code>configuration.query</code></a> property  of a Jobs resource. If a string is provided, this is used as the query  string, and all other options are defaulted.</li> </ul> ","types":["object","string"],"optional":false,"nullable":false},{"name":"options.destination","description":"<ul> <li>The table to save the query&#39;s results to. If omitted, a new table will be created.</li> </ul> ","types":["<a data-custom-type=\"bigquery/table\" data-method=\"\">bigquery/table</a>"],"optional":true,"nullable":false},{"name":"options.query","description":"<ul> <li>A query string, following the BigQuery query syntax, of the query to execute.</li> </ul> ","types":["string"],"optional":false,"nullable":false},{"name":"callback","description":"<ul> <li>The callback function.</li> </ul> ","types":["function"],"optional":false,"nullable":false},{"name":"callback.err","description":"<ul> <li>An error returned while making this request.</li> </ul> ","types":["error"],"optional":false,"nullable":true},{"name":"callback.job","description":"<ul> <li>The newly created job for your query.</li> </ul> ","types":["<a data-custom-type=\"bigquery/job\" data-method=\"\">bigquery/job</a>"],"optional":false,"nullable":false},{"name":"callback.apiResponse","description":"<ul> <li>The full API response.</li> </ul> ","types":["object"],"optional":false,"nullable":false}],"exceptions":[{"type":"Error","description":"<p>If a query is not specified.</p>"},{"type":"Error","description":"<p>If a Table is not provided as a destination.</p>"}],"returns":[]}]}