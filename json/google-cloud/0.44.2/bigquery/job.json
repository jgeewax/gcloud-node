{"id":"bigquery/job","type":"class","name":"Job","overview":"<p>\n  This class allows you interact with Google BigQuery.\n</p>\n\n<p>\n  First, install <code>google-cloud</code> with npm:\n</p>\n\n<div hljs language=\"bash\">$ npm install --save google-cloud</div>\n\n<p>\n  If you are running your app on Google Compute Engine, you won't need to worry about supplying connection configuration options to <code>google-cloud</code>â€” we figure that out for you.\n</p>\n\n<p>\n  However, if you're running your app elsewhere, you will need to provide project details to authenticate API requests.\n</p>\n\n<h4>Compute Engine</h4>\n<div hljs language=\"javascript\">\nvar gcloud = require('google-cloud');\nvar bigquery = gcloud.bigquery();\n</div>\n\n<h4>Elsewhere</h4>\n<div hljs language=\"javascript\">\nvar gcloud = require('google-cloud');\nvar bigquery = gcloud.bigquery({\n  projectId: 'grape-spaceship-123',\n  keyFilename: '/path/to/keyfile.json'\n});\n</div>\n\n<p>\n  The full set of options which can be passed to <code>google-cloud</code> are outlined in our <a href=\"#/docs/google-cloud/0.44.2/guides/authentication\">Authentication guide</a>.\n</p>\n\n","description":"","source":"packages/bigquery/src/job.js","parent":"bigquery","children":[],"methods":[{"id":"Job","name":"Job","type":"constructor","description":"<p>Job objects are returned from various places in the BigQuery API:</p><ul> <li><a data-custom-type=\"bigquery\" data-method=\"getJobs\">bigquery#getJobs</a></li> <li><a data-custom-type=\"bigquery\" data-method=\"job\">bigquery#job</a></li> <li><a data-custom-type=\"bigquery\" data-method=\"query\">bigquery#query</a></li> <li><a data-custom-type=\"bigquery\" data-method=\"startJob\">bigquery#startJob</a></li> <li><a data-custom-type=\"bigquery/table\" data-method=\"copy\">bigquery/table#copy</a></li> <li><a data-custom-type=\"bigquery/table\" data-method=\"createWriteStream\">bigquery/table#createWriteStream</a></li> <li><a data-custom-type=\"bigquery/table\" data-method=\"export\">bigquery/table#export</a></li> <li><a data-custom-type=\"bigquery/table\" data-method=\"import\">bigquery/table#import</a></li> </ul> <p>They can be used to check the status of a running job or fetching the results of a previously-executed one.</p>","source":"packages/bigquery/src/job.js#L77","resources":[],"examples":[{"code":"var job = bigquery.job('job-id');"},{"caption":"<p>All jobs are event emitters. The status of each job is polled \ncontinuously, starting only after you register a \"complete\" listener.</p>","code":"job.on('complete', function(metadata) {\n  // The job is complete.\n});"},{"caption":"<p>Be sure to register an error handler as well to catch any issues which \nimpeded the job.</p>","code":"job.on('error', function(err) {\n  // An error occurred during the job.\n});"},{"caption":"<p>To force the Job object to stop polling for updates, simply remove any \n\"complete\" listeners you've registered. \nThe easiest way to do this is with <code>removeAllListeners()</code>.</p>","code":"job.removeAllListeners();"}],"params":[],"exceptions":[],"returns":[]},{"id":"exists","name":"exists","type":"instance","description":"<p>Check if the job exists.</p>","source":"packages/bigquery/src/job.js#L97","resources":[],"examples":[{"code":"job.exists(function(err, exists) {});"},{"caption":"<p>If the callback is omitted, we'll return a Promise.</p>","code":"job.exists().then(function(data) {\n  var exists = data[0];\n});"}],"params":[{"name":"callback","description":"<ul> <li>The callback function.</li> </ul> ","types":["function"],"optional":false,"nullable":false},{"name":"callback.err","description":"<ul> <li>An error returned while making this request.</li> </ul> ","types":["error"],"optional":false,"nullable":true},{"name":"callback.exists","description":"<ul> <li>Whether the job exists or not.</li> </ul> ","types":["boolean"],"optional":false,"nullable":false}],"exceptions":[],"returns":[]},{"id":"get","name":"get","type":"instance","description":"<p>Get a job if it exists.</p>","source":"packages/bigquery/src/job.js#L117","resources":[],"examples":[{"code":"job.get(function(err, job, apiResponse) {\n  if (!err) {\n    // `job.metadata` has been populated.\n  }\n});"},{"caption":"<p>If the callback is omitted, we'll return a Promise.</p>","code":"job.get().then(function(data) {\n  var job = data[0];\n  var apiResponse = data[1];\n});"}],"params":[],"exceptions":[],"returns":[]},{"id":"getMetadata","name":"getMetadata","type":"instance","description":"<p>Get the metadata of the job. This will mostly be useful for checking the status of a previously-run job.</p>","source":"packages/bigquery/src/job.js#L143","resources":[{"title":"Jobs: get API Documentation","link":"https://cloud.google.com/bigquery/docs/reference/v2/jobs/get"}],"examples":[{"code":"var job = bigquery.job('id');\njob.getMetadata(function(err, metadata, apiResponse) {});"},{"caption":"<p>If the callback is omitted, we'll return a Promise.</p>","code":"job.getMetadata().then(function(data) {\n  var metadata = data[0];\n  var apiResponse = data[1];\n});"}],"params":[{"name":"callback","description":"<ul> <li>The callback function.</li> </ul> ","types":["function"],"optional":false,"nullable":false},{"name":"callback.err","description":"<ul> <li>An error returned while making this request.</li> </ul> ","types":["error"],"optional":false,"nullable":true},{"name":"callback.metadata","description":"<ul> <li>The metadata of the job.</li> </ul> ","types":["object"],"optional":false,"nullable":false},{"name":"callback.apiResponse","description":"<ul> <li>The full API response.</li> </ul> ","types":["object"],"optional":false,"nullable":false}],"exceptions":[],"returns":[]},{"id":"cancel","name":"cancel","type":"instance","description":"<p>Cancel a job. Use <a data-custom-type=\"bigquery/job\" data-method=\"getMetadata\">bigquery/job#getMetadata</a> to see if the cancel completes successfully. See an example implementation below.</p>","source":"packages/bigquery/src/job.js#L194","resources":[{"title":"Jobs: get API Documentation","link":"https://cloud.google.com/bigquery/docs/reference/v2/jobs/cancel"}],"examples":[{"code":"job.cancel(function(err, apiResponse) {\n  // Check to see if the job completes successfully.\n  job.on('error', function(err) {});\n  job.on('complete', function(metadata) {});\n});"},{"caption":"<p>If the callback is omitted, we'll return a Promise.</p>","code":"job.cancel().then(function(data) {\n  var apiResponse = data[0];\n});"}],"params":[{"name":"callback","description":"<ul> <li>The callback function.</li> </ul> ","types":["function"],"optional":true,"nullable":false},{"name":"callback.err","description":"<ul> <li>An error returned while making this request.</li> </ul> ","types":["error"],"optional":false,"nullable":true},{"name":"callback.apiResponse","description":"<ul> <li>The full API response.</li> </ul> ","types":["object"],"optional":false,"nullable":false}],"exceptions":[],"returns":[]},{"id":"getQueryResults","name":"getQueryResults","type":"instance","description":"<p>Get the results of a job.</p>","source":"packages/bigquery/src/job.js#L271","resources":[{"title":"Jobs: getQueryResults API Documentation","link":"https://cloud.google.com/bigquery/docs/reference/v2/jobs/getQueryResults"}],"examples":[{"caption":"<p>Get all of the results of a query.</p>","code":"job.getQueryResults(function(err, rows) {\n  if (!err) {\n    // rows is an array of results.\n  }\n});"},{"caption":"<p>Customize the results you want to fetch.</p>","code":"job.getQueryResults({\n  maxResults: 100\n}, function(err, rows) {});"},{"caption":"<p>To control how many API requests are made and page through the results \nmanually, set <code>autoPaginate</code> to <code>false</code>.</p>","code":"var callback = function(err, rows, nextQuery, apiResponse) {\n  if (nextQuery) {\n    // More results exist.\n    job.getQueryResults(nextQuery, callback);\n  }\n};\n\njob.getQueryResults({\n  autoPaginate: false\n}, callback);"},{"caption":"<p>If the callback is omitted, we'll return a Promise.</p>","code":"job.getQueryResults().then(function(data) {\n  var rows = data[0];\n});"}],"params":[{"name":"options","description":"<ul> <li>Configuration object.</li> </ul> ","types":["object"],"optional":true,"nullable":false},{"name":"options.autoPaginate","description":"<ul> <li>Have pagination handled automatically. Default: true.</li> </ul> ","types":["boolean"],"optional":false,"nullable":false},{"name":"options.maxApiCalls","description":"<ul> <li>Maximum number of API calls to make.</li> </ul> ","types":["number"],"optional":false,"nullable":false},{"name":"options.maxResults","description":"<ul> <li>Maximum number of results to read.</li> </ul> ","types":["number"],"optional":false,"nullable":false},{"name":"options.pageToken","description":"<ul> <li>Page token, returned by a previous call, to request the next page of results. Note: This is automatically added to  the <code>nextQuery</code> argument of your callback.</li> </ul> ","types":["string"],"optional":false,"nullable":false},{"name":"options.startIndex","description":"<ul> <li>Zero-based index of the starting row.</li> </ul> ","types":["number"],"optional":false,"nullable":false},{"name":"options.timeoutMs","description":"<ul> <li>How long to wait for the query to complete, in milliseconds, before returning. Default is to return  immediately. If the timeout passes before the job completes, the request  will fail with a <code>TIMEOUT</code> error.</li> </ul> ","types":["number"],"optional":false,"nullable":false},{"name":"callback","description":"<ul> <li>The callback function. If you intend to continuously run this query until all results are in as part of a stream,  do not pass a callback.</li> </ul> ","types":["function"],"optional":true,"nullable":false},{"name":"callback.err","description":"<ul> <li>An error returned while making this request</li> </ul> ","types":["error"],"optional":false,"nullable":true},{"name":"callback.rows","description":"<ul> <li>The results of a job.</li> </ul> ","types":["array"],"optional":false,"nullable":false},{"name":"callback.nextQuery","description":"<ul> <li>If present, query with this object to check for more results.</li> </ul> ","types":["object"],"optional":false,"nullable":true},{"name":"callback.apiResponse","description":"<ul> <li>The full API response.</li> </ul> ","types":["object"],"optional":false,"nullable":false}],"exceptions":[],"returns":[]},{"id":"getQueryResultsStream","name":"getQueryResultsStream","type":"instance","description":"<p>Get the results of a job as a readable object stream.</p>","source":"packages/bigquery/src/job.js#L300","resources":[],"examples":[{"code":"var through2 = require('through2');\nvar fs = require('fs');\n\njob.getQueryResultsStream()\n  .pipe(through2.obj(function (row, enc, next) {\n    this.push(JSON.stringify(row) + '\\n');\n    next();\n  }))\n  .pipe(fs.createWriteStream('./test/testdata/testfile.json'));"}],"params":[{"name":"options","description":"<ul> <li>Configuration object. See <a data-custom-type=\"bigquery/job\" data-method=\"getQueryResults\">bigquery/job#getQueryResults</a> for a complete list of options.</li> </ul> ","types":["object"],"optional":true,"nullable":false}],"exceptions":[],"returns":[{"types":["stream"],"description":""}]}],"path":"job.json"}